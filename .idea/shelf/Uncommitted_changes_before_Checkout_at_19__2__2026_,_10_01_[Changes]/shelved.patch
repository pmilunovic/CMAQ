Index: scripts/bcon/bldit.bcon
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>#! /bin/csh -f\n\n# ===================== BCONv5.0.2 Build Script ===================== #\n# Usage: bldit.bcon >&! bldit.bcon.log                                #\n# Requirements: I/O API & netCDF libs, and a Fortran compiler         #\n# Note that this script is configured/tested for Red Hat Linux O/S    #\n# The following environment variables must be set for this script to  #\n# build an executable.                                                #\n#   setenv M3MODEL <source code repository>                           #\n#   setenv M3LIB   <code libraries>                                   #\n# To report problems or request help with this script/program:        #\n#             http://www.cmascenter.org/html/help.html                #\n# =================================================================== #\n\n#> Source the config.cmaq file to set the build environment\n source ../config.cmaq\n\n#> Check for M3HOME and M3LIB settings:\n if ( ! -e $M3HOME || ! -e $M3LIB ) then\n    echo \"   $M3HOME or $M3LIB directory not found\"\n    exit 1\n endif\n echo \"    Model repository base path: $M3HOME\"\n echo \"                  library path: $M3LIB\"\n\n#> If $M3MODEL not set, default to $M3HOME\n if ( $?M3MODEL ) then\n    echo \"         Model repository path: $M3MODEL\"\n else\n    setenv M3MODEL $M3HOME\n    echo \" default Model repository path: $M3MODEL\"\n endif\n\n set BLD_OS = `uname -s`        ## Script set up for Linux only \n if ($BLD_OS != 'Linux') then\n    echo \"   $BLD_OS -> wrong bldit script for host!\"\n    exit 1\n endif\n\n set echo\n\n#:#:#:#:#:#:#:#:#:#:#:# Begin User Input Section #:#:#:#:#:#:#:#:#:#:#:#\n\n#> user choices: Git repository\n set GlobInc = $M3HOME/models/CCTM/ICL\n set Mechs   = $M3HOME/models/CCTM/MECHS\n#git --work-tree=$M3MODEL status\n#git status\n setenv REPOROOT $M3MODEL/BCON\n\n#> user choices: base working directory\n set Base = $cwd\n set APPL  = D502a\n set CFG   = cfg.$APPL\n set MODEL = BCON_${APPL}_$EXEC_ID\n\n#set Local   # do NOT copy the source files into the BLD directory -\n             # comment out to copy the source files (default if not set)\n\n#> The \"BLD\" directory for checking out and compiling source code\n set Bld = $Base/BLD_${APPL}\n if ( ! -e \"$Bld\" ) then\n    mkdir $Bld\n else\n    if ( ! -d \"$Bld\" ) then\n       echo \"   *** target exists, but not a directory ***\"\n       exit 1\n    endif\n endif\n\n cd $Bld\n\n#> user choices: bldmake command\n#set MakeFileOnly   # builds a Makefile to make the model, but does not compile -\n                    # comment out to also compile the model (default if not set)\n\n#> user choices: various modules\n\n set ModCommon = common\n\n#> If this is a nested simulation, use the m3conc option to extract BCs from a CCTM CONC file\n set ModType   = profile\n#set ModType   = m3conc\n#set ModType   = tracer\n\n set ModMech   = prof_data/cb05_ae6_aq\n#set ModMech   = prof_data/saprc99_ae6_aq\n#set ModMech   = prof_data/saprc07t_ae6_aq\n\n#> user choices: mechanism\n#set Mechanism = cb05cl_ae5_aq\n#set Mechanism = cb05tucl_ae5_aq\n set Mechanism = cb05tucl_ae6_aq\n#set Mechanism = cb05tump_ae6_aq\n#set Mechanism = saprc99_ae5_aq\n#set Mechanism = saprc99_ae6_aq\n#set Mechanism = saprc07tb_ae6_aq\n#set Mechanism = saprc07tc_ae6_aq\n set Tracer    = trac0               # default: no tracer species\n\n#> user choices: computing system configuration:\n#>    name of the \"BLD\" directory for checking out and compiling source code\n#>    compiler name and location/link flags\n#>    library paths\n\n set Bld = $Base/BLD_${APPL}\n\n#> Set full path of Fortran 90 compiler\n set FC = ${myFC}\n set FP = $FC\n\n#> Set location of M3Bld executable\n set Blder = $M3LIB/bldmake\n\n#> Set location of libraries/include files\n set IOAPI  = \"${M3LIB}/ioapi_3.1/Linux2_${system}${compiler_ext} -lioapi\"\n set IOAPIMOD = ${M3LIB}/ioapi_3.1/Linux2_${system}${compiler_ext}\n\n set NETCDF = \"${M3LIB}/netcdf/lib -lnetcdf\"\n\n#> Set compiler flags\n set F_FLAGS    = \"${myFFLAGS} -I ${IOAPIMOD} -I.\"\n set F90_FLAGS  = \"${myFRFLAGS} -I ${IOAPIMOD} -I.\"\n set CPP_FLAGS  = \"\"\n set C_FLAGS    = \"${myCFLAGS} -DFLDMN\"\n set LINK_FLAGS = \"${myLINK_FLAG}\"\n\n#:#:#:#:#:#:#:#:#:#:#:# End of User Input Section :#:#:#:#:#:#:#:#:#:#:#:#:#\n\n if ( ! -e \"$Bld\" ) then\n    mkdir $Bld\n else\n    if ( ! -d \"$Bld\" ) then\n       echo \"   *** target exists, but not a directory ***\"\n       exit 1\n    endif\n endif\n \n cd $Bld\n\n#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#\n\n set Str1 =\n set Str2 =\n\n set LIB1 = \"-L${IOAPI}\"\n set LIB2 = \"-L${NETCDF}\"\n set LIBS = \"$LIB1 $LIB2 ${extra_lib}\"\n\n source $Base/relinc.bcon\n if ( $status ) exit 1\n\n set ICL_MECH  = $Mechs/$Mechanism\n set ICL_TRAC  = $Mechs/$Tracer\n\n#> make the config file\n\n set Cfile = ${CFG}.bld\n set quote = '\"'\n\n echo                                                               > $Cfile\n echo \"model       $MODEL;\"                                        >> $Cfile\n echo                                                              >> $Cfile\n echo \"FPP         $FP;\"                                           >> $Cfile\n echo                                                              >> $Cfile\n set text = \"$quote$CPP_FLAGS$quote;\"\n echo \"cpp_flags   $text\"                                          >> $Cfile\n echo                                                              >> $Cfile\n echo \"f_compiler  $FC;\"                                           >> $Cfile\n echo                                                              >> $Cfile\n echo \"f_flags     $quote$F_FLAGS$quote;\"                          >> $Cfile\n echo                                                              >> $Cfile\n echo \"f90_flags   $quote$F90_FLAGS$quote;\"                        >> $Cfile\n echo                                                              >> $Cfile\n echo \"c_flags     $quote$C_FLAGS$quote;\"                          >> $Cfile\n echo                                                              >> $Cfile\n echo \"link_flags  $quote$LINK_FLAGS$quote;\"                       >> $Cfile\n echo                                                              >> $Cfile\n echo \"libraries   $quote$LIBS$quote;\"                             >> $Cfile\n echo                                                              >> $Cfile\n\n set text=\"// mechanism:\"\n echo \"$text ${Mechanism}\"                                         >> $Cfile\n echo \"// model repository: ${M3MODEL}\"                            >> $Cfile\n echo                                                              >> $Cfile\n if ( $compiler == gfort ) then\n   set ICL_CONST = '.'\n   set ICL_MECH = '.'\n endif\n echo \"include SUBST_RXCMMN     $ICL_MECH/RXCM.EXT;\"               >> $Cfile\n echo \"include SUBST_RXDATA     $ICL_MECH/RXDT.EXT;\"               >> $Cfile\n echo                                                              >> $Cfile\n\n echo \"$Str1\"                                                      >> $Cfile\n echo \"$Str2\"                                                      >> $Cfile\n echo                                                              >> $Cfile\n\n set text = \"common\"\n echo \"// options are\" $text                                       >> $Cfile\n echo \"Module ${ModCommon};\"                                       >> $Cfile\n echo                                                              >> $Cfile\n\n set text = \"profile, m3conc, tracer\"\n echo \"// options are\" $text                                       >> $Cfile\n echo \"Module ${ModType};\"                                         >> $Cfile\n echo                                                              >> $Cfile\n\n set text = \"cb05, saprc99, saprc07t\"\n echo \"// options are\" $text                                       >> $Cfile\n echo \"Module ${ModMech};\"                                         >> $Cfile\n echo                                                              >> $Cfile\n\n if ( $?ModMisc ) then\n    echo \"Module ${ModMisc};\"                                      >> $Cfile\n    echo                                                           >> $Cfile\n endif\n\n#> make the Makefile or the model executable\n\n unalias mv rm\n if ( $?MakeFileOnly ) then\n    if ( $?Local ) then\n       $Blder -makefo -git_local $Cfile   # $Cfile = ${CFG}.bld\n    else\n       $Blder -makefo $Cfile\n     # totalview -a $Blder -makefo $Cfile\n    endif\n else   # also compile the model\n    if ( $?Local ) then\n       $Blder -git_local $Cfile\n    else\n       $Blder $Cfile\n    endif\n endif\n\n mv Makefile $Bld/Makefile.$COMPILER\n if ( -e $Bld/Makefile.$COMPILER && -e $Bld/Makefile ) rm $Bld/Makefile\n ln -s $Bld/Makefile.$COMPILER $Bld/Makefile\n\n if ( $status != 0 ) then\n    echo \"   *** failure in $Blder ***\"\n    exit 1\n endif\n if ( -e \"$Base/${CFG}\" ) then\n    echo \"   >>> previous ${CFG} exists, re-naming to ${CFG}.old <<<\"\n    mv $Base/${CFG} $Base/${CFG}.old\n endif\n mv ${CFG}.bld $Bld/${CFG}\n\n set is_using_git = `ls -alog $M3MODEL | grep git | wc -l`\n\n if ( $is_using_git[1] ) then\n#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#:#\n cd $M3MODEL\n#set brnch = `git --work-tree=$M3MODEL branch`\n set brnch = `git branch`\n @ i = 0\n while ( $i < $#brnch )\n    @ i++\n    if ( \"$brnch[$i]\" == \"*\" ) @ l = $i + 1\n end\n#set rep = `echo $M3MODEL | tr \"/\" \"#\"`\n set rep = `echo $cwd | tr \"/\" \"#\"`\n set rln = \"repo:${rep},branch:${brnch[$l]},compiler:${COMPILER}\"\n set ref = $Bld/$rln\n /bin/touch $ref\n if ( -d $M3MODEL/branch ) /bin/cp $M3MODEL/branch/branch.* $Bld\nendif\n\n exit\n
===================================================================
diff --git a/scripts/bcon/bldit.bcon b/scripts/bcon/bldit.bcon
--- a/scripts/bcon/bldit.bcon	(revision f1850a13fb2a5ba232eda4528a25a5d38266fa36)
+++ b/scripts/bcon/bldit.bcon	(date 1770630864136)
@@ -1,5 +1,6 @@
 #! /bin/csh -f
 
+#
 # ===================== BCONv5.0.2 Build Script ===================== #
 # Usage: bldit.bcon >&! bldit.bcon.log                                #
 # Requirements: I/O API & netCDF libs, and a Fortran compiler         #
@@ -33,7 +34,7 @@
 
  set BLD_OS = `uname -s`        ## Script set up for Linux only 
  if ($BLD_OS != 'Linux') then
-    echo "   $BLD_OS -> wrong bldit script for host!"
+    echo "   $BLD_OS -> wrong misko pisko script for host!"
     exit 1
  endif
 
